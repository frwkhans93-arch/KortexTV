<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KorexTV - Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø´Ø±Ù</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .logout-btn {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: var(--error-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }
        
        .stat-item {
            background: #2a2a2a;
            padding: 1rem;
            border-radius: 10px;
            text-align: center;
        }
        
        .table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            background: #2a2a2a;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .table th, .table td {
            padding: 1rem;
            text-align: right;
            border-bottom: 1px solid #333;
        }
        
        .table th {
            background: var(--primary-color);
            color: white;
        }
        
        .table tr:hover {
            background: #333;
        }
        
        .action-btn {
            background: #333;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            margin: 0 2px;
            font-size: 0.8rem;
        }
        
        .action-btn.edit { background: #007bff; }
        .action-btn.delete { background: var(--error-color); }
        .action-btn.view { background: var(--success-color); }
        
        .email-notification {
            background: #2a2a2a;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
            border-left: 4px solid var(--accent-color);
        }
        
        .badge {
            background: var(--primary-color);
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.7rem;
            margin-right: 5px;
        }
        
        .online-badge { background: var(--success-color); }
        .offline-badge { background: var(--error-color); }
        .premium-badge { background: var(--accent-color); color: #000; }
    </style>
</head>
<body>
    <!-- Ù‡ÙŠØ¯Ø± Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… -->
    <header class="header">
        <button class="logout-btn" onclick="logout()">ğŸšª Ø®Ø±ÙˆØ¬</button>
        <h1>ğŸ›ï¸ Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… KorexTV</h1>
        <p>Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„ÙƒØ§Ù…Ù„ ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙˆØ§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</p>
    </header>
    
    <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ -->
    <nav class="admin-nav">
        <button class="nav-btn active" onclick="showSection('dashboard')">ğŸ“Š Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</button>
        <button class="nav-btn" onclick="showSection('users')">ğŸ‘¥ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</button>
        <button class="nav-btn" onclick="showSection('series')">ğŸ¬ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³Ù„Ø³Ù„Ø§Øª</button>
        <button class="nav-btn" onclick="showSection('analytics')">ğŸ“ˆ Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª</button>
        <button class="nav-btn" onclick="showSection('settings')">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
    </nav>
    
    <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <div class="admin-content">
        
        <!-- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
        <div id="dashboard" class="section active">
            <h2>ğŸ“Š Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©</h2>
            <div class="dashboard-cards">
                <div class="card">
                    <h3>ğŸ‘¥ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h3>
                    <div class="number" id="total-users">0</div>
                    <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†</p>
                </div>
                <div class="card">
                    <h3>ğŸ¬ Ø§Ù„Ù…Ø³Ù„Ø³Ù„Ø§Øª</h3>
                    <div class="number" id="total-series">0</div>
                    <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³Ù„Ø³Ù„Ø§Øª Ø§Ù„Ù…Ø¶Ø§ÙØ©</p>
                </div>
                <div class="card">
                    <h3>ğŸ“º Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø§Øª</h3>
                    <div class="number" id="total-views">0</div>
                    <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù…Ø±Ø§Øª Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø©</p>
                </div>
                <div class="card">
                    <h3>ğŸ’° Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</h3>
                    <div class="number" id="total-revenue">0$</div>
                    <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</p>
                </div>
            </div>
            
            <div class="stats-grid">
                <div class="stat-item">
                    <h4>ğŸ“± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†</h4>
                    <div style="font-size: 1.5rem; color: var(--success-color);" id="active-users">0</div>
                </div>
                <div class="stat-item">
                    <h4>â­ Ù…ØªÙˆØ³Ø· Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</h4>
                    <div style="font-size: 1.5rem; color: var(--accent-color);" id="avg-rating">0</div>
                </div>
                <div class="stat-item">
                    <h4>ğŸ¯ Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ø­ØªÙØ§Ø¸</h4>
                    <div style="font-size: 1.5rem; color: #007bff;" id="retention-rate">0%</div>
                </div>
                <div class="stat-item">
                    <h4>ğŸ“§ Ø§Ø´ØªØ±Ø§ÙƒØ§Øª Ø§Ù„Ø¨Ø±ÙŠØ¯</h4>
                    <div style="font-size: 1.5rem; color: var(--accent-color);" id="email-subscribers">0</div>
                </div>
            </div>
            
            <div class="email-notification">
                <h4>ğŸ“§ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</h4>
                <p>Ø³ÙŠØµÙ„Ùƒ Ø¥Ø´Ø¹Ø§Ø± Ø¹Ù„Ù‰ <strong>frwkhans93@gmail.com</strong> Ø¹Ù†Ø¯ ÙƒÙ„ ØªØ³Ø¬ÙŠÙ„ Ø¬Ø¯ÙŠØ¯</p>
                <button class="btn" onclick="testEmailNotification()">ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±</button>
            </div>
        </div>
        
        <!-- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† -->
        <div id="users" class="section">
            <h2>ğŸ‘¥ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h2>
            
            <div class="form-group">
                <input type="text" id="search-users" placeholder="ğŸ” Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†..." onkeyup="searchUsers()">
            </div>
            
            <table class="table">
                <thead>
                    <tr>
                        <th>Ø§Ù„Ø§Ø³Ù…</th>
                        <th>Ø§Ù„Ø¨Ø±ÙŠØ¯</th>
                        <th>Ø§Ù„Ù†Ù‚Ø§Ø·</th>
                        <th>Ø§Ù„Ù…Ø³ØªÙˆÙ‰</th>
                        <th>Ø¢Ø®Ø± Ø¯Ø®ÙˆÙ„</th>
                        <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                        <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                    </tr>
                </thead>
                <tbody id="users-list">
                    <!-- Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙŠØ¸Ù‡Ø±ÙˆÙ† Ù‡Ù†Ø§ -->
                </tbody>
            </table>
        </div>
        
        <!-- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³Ù„Ø³Ù„Ø§Øª -->
        <div id="series" class="section">
            <h2>ğŸ¬ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³Ù„Ø³Ù„Ø§Øª</h2>
            
            <div class="form-group">
                <h3>â• Ø¥Ø¶Ø§ÙØ© Ù…Ø³Ù„Ø³Ù„ Ø¬Ø¯ÙŠØ¯</h3>
                <input type="text" id="series-title" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³Ù„Ø³Ù„">
                <input type="text" id="series-emoji" placeholder="Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ (Ù…Ø«Ø§Ù„: ğŸ’–)">
                <input type="number" id="series-rating" placeholder="Ø§Ù„ØªÙ‚ÙŠÙŠÙ… (1-5)" min="1" max="5" step="0.1">
                <input type="number" id="series-episodes" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ù„Ù‚Ø§Øª">
                <input type="text" id="series-year" placeholder="Ø³Ù†Ø© Ø§Ù„Ø¥Ù†ØªØ§Ø¬">
                <input type="color" id="series-color" value="#ff6b6b">
                <textarea id="series-description" placeholder="ÙˆØµÙ Ø§Ù„Ù…Ø³Ù„Ø³Ù„" rows="3"></textarea>
                <button class="btn" onclick="addSeries()">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³Ù„Ø³Ù„</button>
            </div>
            
            <h3>ğŸ“‹ Ø§Ù„Ù…Ø³Ù„Ø³Ù„Ø§Øª Ø§Ù„Ù…Ø¶Ø§ÙØ©</h3>
            <div class="table-container">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ</th>
                            <th>Ø§Ø³Ù… Ø§Ù„Ù…Ø³Ù„Ø³Ù„</th>
                            <th>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</th>
                            <th>Ø§Ù„Ø­Ù„Ù‚Ø§Øª</th>
                            <th>Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø§Øª</th>
                            <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                        </tr>
                    </thead>
                    <tbody id="series-list">
                        <!-- Ø§Ù„Ù…Ø³Ù„Ø³Ù„Ø§Øª ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª -->
        <div id="analytics" class="section">
            <h2>ğŸ“ˆ Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª ÙˆØ§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</h2>
            
            <div class="stats-grid">
                <div class="stat-item">
                    <h4>ğŸ“… Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø¬Ø¯Ø¯ Ø§Ù„ÙŠÙˆÙ…</h4>
                    <div style="font-size: 1.5rem; color: var(--success-color);" id="new-users-today">0</div>
                </div>
                <div class="stat-item">
                    <h4>ğŸ¬ Ù…Ø´Ø§Ù‡Ø¯Ø§Øª Ø§Ù„ÙŠÙˆÙ…</h4>
                    <div style="font-size: 1.5rem; color: #007bff;" id="views-today">0</div>
                </div>
                <div class="stat-item">
                    <h4>ğŸ’° Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„ÙŠÙˆÙ…</h4>
                    <div style="font-size: 1.5rem; color: var(--accent-color);" id="revenue-today">0$</div>
                </div>
                <div class="stat-item">
                    <h4>ğŸ“Š Ù…ØªÙˆØ³Ø· Ø§Ù„Ø¬Ù„Ø³Ø©</h4>
                    <div style="font-size: 1.5rem; color: var(--primary-color);" id="avg-session">0 Ø¯</div>
                </div>
            </div>
            
            <button class="btn" onclick="generateReport()">ğŸ“¥ ØªØµØ¯ÙŠØ± ØªÙ‚Ø±ÙŠØ±</button>
            <button class="btn" onclick="sendDailyReport()">ğŸ“§ Ø¥Ø±Ø³Ø§Ù„ ØªÙ‚Ø±ÙŠØ± ÙŠÙˆÙ…ÙŠ</button>
        </div>
        
        <!-- Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª -->
        <div id="settings" class="section">
            <h2>âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</h2>
            
            <div class="form-group">
                <h4>ğŸ¯ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</h4>
                <label>Ø§Ø³Ù… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚:</label>
                <input type="text" id="app-name" value="KorexTV">
                
                <label>ÙˆØµÙ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚:</label>
                <textarea id="app-description" rows="2">Ù…Ø³Ù„Ø³Ù„Ø§Øª ÙƒÙˆØ±ÙŠØ© ÙÙŠ Ù…Ù‚Ø§Ø·Ø¹ Ù‚ØµÙŠØ±Ø©</textarea>
                
                <label>Ø³Ø¹Ø± Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ø´Ù‡Ø±ÙŠ ($):</label>
                <input type="number" id="subscription-price" value="5">
                
                <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø¨ÙŠÙ† Ø§Ù„Ù…Ù‚Ø§Ø·Ø¹:</label>
                <input type="number" id="ads-frequency" value="2" min="1" max="10">
            </div>
            
            <div class="form-group">
                <h4>ğŸ¨ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¸Ù‡Ø±</h4>
                <label>Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ:</label>
                <input type="color" id="primary-color" value="#e50914">
                
                <label>Ù„ÙˆÙ† Ø§Ù„Ø®Ù„ÙÙŠØ©:</label>
                <input type="color" id="bg-color" value="#0f0f0f">
            </div>
            
            <button class="btn" onclick="saveSettings()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
            <button class="btn" onclick="resetSettings()">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>
        </div>
    </div>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <script src="firebase-config.js"></script>
    <script>
        // Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
        class AdminManager {
            constructor() {
                this.users = JSON.parse(localStorage.getItem('korextv_users') || '[]');
                this.series = JSON.parse(localStorage.getItem('korextv_series') || '[]');
                this.settings = JSON.parse(localStorage.getItem('korextv_settings') || this.getDefaultSettings());
                this.activities = JSON.parse(localStorage.getItem('korextv_activities') || '[]');
                
                this.init();
            }
            
            getDefaultSettings() {
                return {
                    appName: "KorexTV",
                    appDescription: "Ù…Ø³Ù„Ø³Ù„Ø§Øª ÙƒÙˆØ±ÙŠØ© ÙÙŠ Ù…Ù‚Ø§Ø·Ø¹ Ù‚ØµÙŠØ±Ø©",
                    subscriptionPrice: 5,
                    adsFrequency: 2,
                    primaryColor: "#e50914",
                    bgColor: "#0f0f0f",
                    emailNotifications: true,
                    autoReports: false
                };
            }
            
            init() {
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ù…Ø´Ø±Ù
                const currentUser = JSON.parse(localStorage.getItem('korextv_currentUser') || 'null');
                if (!currentUser || !currentUser.isAdmin) {
                    window.location.href = 'login.html';
                    return;
                }
                
                this.loadDashboard();
                this.loadUsersList();
                this.loadSeriesList();
                this.loadSettings();
            }
            
            loadDashboard() {
                document.getElementById('total-users').textContent = this.users.length;
                document.getElementById('total-series').textContent = this.series.length;
                
                const totalViews = this.series.reduce((sum, series) => sum + (series.views || 0), 0);
                document.getElementById('total-views').textContent = totalViews.toLocaleString();
                
                const activeUsers = this.users.filter(user => this.isUserActive(user)).length;
                document.getElementById('active-users').textContent = activeUsers;
                
                const avgRating = this.series.length > 0 ? 
                    (this.series.reduce((sum, s) => sum + s.rating, 0) / this.series.length).toFixed(1) : "0";
                document.getElementById('avg-rating').textContent = avgRating;
                
                const retentionRate = this.users.length > 0 ? 
                    Math.round((activeUsers / this.users.length) * 100) : 0;
                document.getElementById('retention-rate').textContent = retentionRate + '%';
            }
            
            isUserActive(user) {
                const lastLogin = new Date(user.lastLogin);
                const today = new Date();
                return (today - lastLogin) < (7 * 24 * 60 * 60 * 1000); // 7 Ø£ÙŠØ§Ù…
            }
            
            loadUsersList() {
                const container = document.getElementById('users-list');
                container.innerHTML = this.users.map(user => `
                    <tr>
                        <td>
                            <strong>${user.name}</strong>
                            ${user.isAdmin ? '<span class="badge">ğŸ‘‘ Ù…Ø´Ø±Ù</span>' : ''}
                            ${user.isPremium ? '<span class="badge premium-badge">ğŸ’ Ù…Ù…ÙŠØ²</span>' : ''}
                        </td>
                        <td>${user.email}</td>
                        <td>${user.points || 0}</td>
                        <td>${user.level || 1}</td>
                        <td>${new Date(user.lastLogin).toLocaleDateString('ar-EG')}</td>
                        <td>
                            <span class="badge ${this.isUserActive(user) ? 'online-badge' : 'offline-badge'}">
                                ${this.isUserActive(user) ? 'ğŸŸ¢ Ù†Ø´Ø·' : 'ğŸ”´ ØºÙŠØ± Ù†Ø´Ø·'}
                            </span>
                        </td>
                        <td>
                            <button class="action-btn view" onclick="viewUser(${user.id})">Ø¹Ø±Ø¶</button>
                            <button class="action-btn edit" onclick="editUser(${user.id})">ØªØ¹Ø¯ÙŠÙ„</button>
                        </td>
                    </tr>
                `).join('');
            }
            
            loadSeriesList() {
                const container = document.getElementById('series-list');
                container.innerHTML = this.series.map(series => `
                    <tr>
                        <td>${series.emoji}</td>
                        <td>${series.title}</td>
                        <td>${'â˜…'.repeat(Math.floor(series.rating))}${'â˜†'.repeat(5-Math.floor(series.rating))} ${series.rating}</td>
                        <td>${series.episodes}</td>
                        <td>${series.views || 0}</td>
                        <td>
                            <button class="action-btn edit" onclick="editSeries(${series.id})">ØªØ¹Ø¯ÙŠÙ„</button>
                            <button class="action-btn delete" onclick="deleteSeries(${series.id})">Ø­Ø°Ù</button>
                        </td>
                    </tr>
                `).join('');
            }
            
            addSeries() {
                const seriesData = {
                    id: Date.now(),
                    title: document.getElementById('series-title').value,
                    emoji: document.getElementById('series-emoji').value,
                    rating: parseFloat(document.getElementById('series-rating').value),
                    episodes: parseInt(document.getElementById('series-episodes').value),
                    year: document.getElementById('series-year').value,
                    color: document.getElementById('series-color').value,
                    description: document.getElementById('series-description').value,
                    views: 0,
                    isNew: true,
                    createdAt: new Date().toISOString()
                };
                
                this.series.push(seriesData);
                this.saveSeries();
                this.loadSeriesList();
                this.clearSeriesForm();
                
                alert('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³Ù„Ø³Ù„ Ø¨Ù†Ø¬Ø§Ø­!');
            }
            
            clearSeriesForm() {
                document.getElementById('series-title').value = '';
                document.getElementById('series-emoji').value = '';
                document.getElementById('series-rating').value = '';
                document.getElementById('series-episodes').value = '';
                document.getElementById('series-year').value = '';
                document.getElementById('series-color').value = '#ff6b6b';
                document.getElementById('series-description').value = '';
            }
            
            loadSettings() {
                document.getElementById('app-name').value = this.settings.appName;
                document.getElementById('app-description').value = this.settings.appDescription;
                document.getElementById('subscription-price').value = this.settings.subscriptionPrice;
                document.getElementById('ads-frequency').value = this.settings.adsFrequency;
                document.getElementById('primary-color').value = this.settings.primaryColor;
                document.getElementById('bg-color').value = this.settings.bgColor;
            }
            
            saveSettings() {
                this.settings = {
                    appName: document.getElementById('app-name').value,
                    appDescription: document.getElementById('app-description').value,
                    subscriptionPrice: parseFloat(document.getElementById('subscription-price').value),
                    adsFrequency: parseInt(document.getElementById('ads-frequency').value),
                    primaryColor: document.getElementById('primary-color').value,
                    bgColor: document.getElementById('bg-color').value,
                    emailNotifications: true
                };
                
                localStorage.setItem('korextv_settings', JSON.stringify(this.settings));
                alert('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!');
            }
            
            saveSeries() {
                localStorage.setItem('korextv_series', JSON.stringify(this.series));
            }
        }

        // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¯ÙŠØ± Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
        const adminManager = new AdminManager();

        // Ø¯ÙˆØ§Ù„ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');
            
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            const navBtns = document.querySelectorAll('.nav-btn');
            for (let btn of navBtns) {
                if (btn.onclick && btn.onclick.toString().includes(sectionId)) {
                    btn.classList.add('active');
                    break;
                }
            }
        }

        function searchUsers() {
            const searchTerm = document.getElementById('search-users').value.toLowerCase();
            const filteredUsers = adminManager.users.filter(user => 
                user.name.toLowerCase().includes(searchTerm) || 
                user.email.toLowerCase().includes(searchTerm)
            );
            
            const container = document.getElementById('users-list');
            container.innerHTML = filteredUsers.map(user => `
                <tr>
                    <td>
                        <strong>${user.name}</strong>
                        ${user.isAdmin ? '<span class="badge">ğŸ‘‘ Ù…Ø´Ø±Ù</span>' : ''}
                    </td>
                    <td>${user.email}</td>
                    <td>${user.points || 0}</td>
                    <td>${user.level || 1}</td>
                    <td>${new Date(user.lastLogin).toLocaleDateString('ar-EG')}</td>
                    <td>
                        <span class="badge ${adminManager.isUserActive(user) ? 'online-badge' : 'offline-badge'}">
                            ${adminManager.isUserActive(user) ? 'ğŸŸ¢ Ù†Ø´Ø·' : 'ğŸ”´ ØºÙŠØ± Ù†Ø´Ø·'}
                        </span>
                    </td>
                    <td>
                        <button class="action-btn view" onclick="viewUser(${user.id})">Ø¹Ø±Ø¶</button>
                        <button class="action-btn edit" onclick="editUser(${user.id})">ØªØ¹Ø¯ÙŠÙ„</button>
                    </td>
                </tr>
            `).join('');
        }

        function addSeries() {
            adminManager.addSeries();
        }

        function saveSettings() {
            adminManager.saveSettings();
        }

        function resetSettings() {
            if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§ØªØŸ')) {
                adminManager.settings = adminManager.getDefaultSettings();
                adminManager.loadSettings();
                localStorage.setItem('korextv_settings', JSON.stringify(adminManager.settings));
                alert('âœ… ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª!');
            }
        }

        function generateReport() {
            const report = `
ØªÙ‚Ø±ÙŠØ± KorexTV - ${new Date().toLocaleDateString('ar-EG')}

ğŸ‘¥ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†: ${adminManager.users.length}
ğŸ¬ Ø§Ù„Ù…Ø³Ù„Ø³Ù„Ø§Øª: ${adminManager.series.length}
ğŸ“º Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø§Øª: ${adminManager.series.reduce((sum, s) => sum + (s.views || 0), 0)}
â­ Ù…ØªÙˆØ³Ø· Ø§Ù„ØªÙ‚ÙŠÙŠÙ…: ${adminManager.series.length > 0 ? (adminManager.series.reduce((sum, s) => sum + s.rating, 0) / adminManager.series.length).toFixed(1) : "0"}

-- ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ØªÙ„Ù‚Ø§Ø¦ÙŠØ§ --
            `.trim();
            
            alert('ğŸ“Š ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…:\n\n' + report);
        }

        function sendDailyReport() {
            generateReport();
            alert('ğŸ“§ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¥Ù„Ù‰ frwkhans93@gmail.com');
        }

        function testEmailNotification() {
            alert('ğŸ“§ Ø³ÙŠØµÙ„Ùƒ Ø¥Ø´Ø¹Ø§Ø± Ø§Ø®ØªØ¨Ø§Ø± Ø¹Ù„Ù‰ frwkhans93@gmail.com');
        }

        function logout() {
            if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…ØŸ')) {
                localStorage.removeItem('korextv_currentUser');
                window.location.href = 'login.html';
            }
        }

        // Ø¯ÙˆØ§Ù„ Ù…Ø­Ø§ÙƒØ§Ø©
        function viewUser(id) {
            alert(`ğŸ‘¤ Ø¹Ø±Ø¶ Ù…Ø³ØªØ®Ø¯Ù… #${id} - Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±`);
        }

        function editUser(id) {
            alert(`âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ù…Ø³ØªØ®Ø¯Ù… #${id} - Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±`);
        }

        function editSeries(id) {
            alert(`ğŸ¬ ØªØ¹Ø¯ÙŠÙ„ Ù…Ø³Ù„Ø³Ù„ #${id} - Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±`);
        }

        function deleteSeries(id) {
            if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³Ù„Ø³Ù„ØŸ')) {
                adminManager.series = adminManager.series.filter(s => s.id !== id);
                adminManager.saveSeries();
                adminManager.loadSeriesList();
                adminManager.loadDashboard();
                alert('âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø³Ù„Ø³Ù„ Ø¨Ù†Ø¬Ø§Ø­');
            }
        }
    </script>
</body>
</html>
